<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <title>Application Callbacks Over Time</title>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    </head>
    <body style="font-family: sans-serif; margin: 40px;">
        <h2>Application Callbacks Over Time</h2>
        <div id="plot" style="width:100%;height:600px;"></div>

        <script>
            const data = {{ graph_data|tojson }};
            const traces = data.series.map(s => ({
                x: data.timestamps,
                y: s.values,
                mode: 'lines+markers',
                name: s.name
            }));

            const layout = {
                template: 'plotly_dark',
                title: {
                    text: 'Application Callbacks Over Time',
                    font: { size: 24, family: 'Arial Black' }
                },
                xaxis: {
                    title: 'Timestamp',
                    showgrid: false,
                    tickangle: -45,
                    rangeselector: {
                        buttons: [
                            { count: 15, label: '15m', step: 'minute', stepmode: 'backward' },
                            { count: 1, label: '1h', step: 'hour', stepmode: 'backward' },
                            { count: 6, label: '6h', step: 'hour', stepmode: 'backward' },
                            { count: 1, label: '1d', step: 'day', stepmode: 'backward' },
                            { step: 'all', label: 'All' }
                        ]
                    },
                    rangeslider: { visible: true },
                    type: 'date',
                    tickfont: { size: 12 }
                },
                yaxis: {
                    title: 'Callback Count',
                    showgrid: true,
                    gridcolor: 'rgba(200,200,200,0.2)'
                },
                legend: {
                    orientation: 'h',
                    y: -0.2,
                    xanchor: 'center',
                    x: 0.5,
                    bgcolor: 'rgba(255,255,255,0.5)',
                    bordercolor: 'rgba(0,0,0,0.1)',
                    borderwidth: 1
                },
                hovermode: 'x unified'
            };

            Plotly.newPlot('plot', traces, layout);
        </script>
    </body>
</html>